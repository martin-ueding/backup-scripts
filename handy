#!/bin/bash
# Copyright (c) 2011 Martin Ueding <dev@martin-ueding.de>

# Copies music to the phone and moves pictures and audio notes to a given
# folder on the computer. The music is shrinked to 128 kBit/s to save space on
# the phone using the mp3_packer.

~/Branches/mp3_packer/trunk/mp3_packer.py ~/Musik/Musik/

target=/media/THETA
dropfolder=~/TODO/

if [ -d "$target" ]
then
	time rsync --max-size 15M -vr --size-only --delete --ignore-errors \
		--force --exclude-from "/home/mu/.syncscripts/handy_musik.txt" \
		"/home/mu/.mp3_packer/128/home/mu/Musik/Musik" "$target/MP3/"

	# move pictures
	find "$target/DCIM/" -type f -exec mv '{}' "$dropfolder" \;

	# move audio notes
	find "$target/MSSEMC/Media Files/audio/" -name "*.amr" -type f \
		-exec mv '{}' "$dropfolder" \;

else
	echo -e "ERROR: $target is not mounted"
fi

